package in.co.sunrays.model;

import java.sql.PreparedStatement;
import java.sql.ResultSet;

import com.mysql.jdbc.Connection;

import in.co.sunrays.exception.DatabaseException;
import in.co.sunrays.proj4.util.JDBCDataSource;

public class SubjectModel1 {

public Integer nextPK() throws DatabaseException { 	
	
	Connection conn = null;
	int pk = 0;
	try {
		conn = JDBCDataSource.getconnection();
	    PreparedStatement pstmt = conn.prepareStatement("select MAX(ID) FROM ST_SUBJECT"); 
		ResultSet rs = pstmt.executeQuery();
		while(rs.next()) {
		 pk = rs.getInt(1);
		rs.close();
		
	} catch (Exception e) {
		throw new DatabaseException("Exception : Exception in getting PK");
	} finally {
		JDBCDataSource.closeConnection(conn);
	}
	return pk + 1;
}	
}
